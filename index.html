<!DOCTYPE html>
<html>
<head>
  <title>Legacy Map Viewer</title>
  <style>
    body, html, #app { margin: 0; width: 100%; height: 100%; background: #121212; color: white; font-family: sans-serif; }
    #header { position: absolute; top: 10px; left: 10px; z-index: 5; background: rgba(0,0,0,0.7); padding: 10px; border-radius: 8px; }
  </style>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/reactflow@11.10.1/dist/react-flow.standalone.am.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/reactflow@11.10.1/dist/style.css">
</head>
<body>
  <div id="header">
    <strong>Legacy Map MVP</strong><br>
    <small>Visualizando dependÃªncias do projeto</small>
  </div>
  <div id="app"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;
    const ReactFlow = window.ReactFlow.default;
    const { Background, Controls } = window.ReactFlow;

    function Map() {
      const [nodes, setNodes] = useState([]);
      const [edges, setEdges] = useState([]);

      useEffect(() => {
        // Carrega o JSON gerado pelo scanner
        fetch('./data.json')
          .then(res => res.json())
          .then(data => {
            setNodes(data.nodes);
            setEdges(data.edges);
          })
          .catch(err => console.error("Erro ao carregar data.json. Rode o scanner primeiro!", err));
      }, []);

      return (
        <div style={{ width: '100%', height: '100%' }}>
          <ReactFlow nodes={nodes} edges={edges} fitView>
            <Background color="#333" gap={20} />
            <Controls />
          </ReactFlow>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('app'));
    root.render(<Map />);
  </script>
</body>
</html>
